{% extends "base.html" %}

{% block title %}Students | Geeks Board{% endblock %}

{% block content %}
<div class="mb-8">
    <p class="text-xs uppercase text-slate-500">Group</p>
    <div class="flex flex-wrap gap-3 items-center">
        <h2 class="text-3xl font-semibold text-slate-800">{{ group.name }}</h2>
        <span class="px-3 py-1 rounded-full bg-accent/10 text-accent text-sm">{{ students|length }} students</span>
    </div>
    <p class="text-sm text-slate-500 mt-1">{{ group.subject|default:"General" }} &middot; {{ group.schedule|default:"Schedule TBD" }}</p>
</div>

<div class="grid gap-6 lg:grid-cols-2">
    {% for student in students %}
    <div class="bg-white rounded-2xl shadow-lg p-6 border border-slate-100">
        <div class="flex items-center justify-between mb-3">
            <div>
                <p class="text-lg font-semibold text-slate-800">{{ student.full_name }}</p>
                <p class="text-xs text-slate-500">{{ student.phone|default:"No phone" }}</p>
            </div>
            <div class="text-right">
                <p class="text-xs uppercase text-slate-500">Total</p>
                <p class="text-2xl font-bold text-accent">{{ student.total_points|default:0 }}</p>
            </div>
        </div>
        <div class="space-y-2">
            {% for point in student.points.all|slice:":5" %}
            <div class="flex justify-between text-sm">
                <span class="text-slate-600">{{ point.category.name }}</span>
                <span class="font-semibold text-emerald-600">+{{ point.score }}</span>
            </div>
            {% empty %}
            <p class="text-sm text-slate-500">No points yet.</p>
            {% endfor %}
        </div>
    </div>
    {% endfor %}
</div>

<div class="mt-10 bg-white rounded-2xl shadow-lg p-6 border border-slate-100 max-w-3xl">
    <h3 class="text-xl font-semibold text-slate-800 mb-4">Assign Points</h3>
    <form method="post" class="grid gap-4 md:grid-cols-2">
        {% csrf_token %}
        {% if form.errors %}
        <div class="md:col-span-2 bg-red-50 border border-red-200 text-red-700 text-sm rounded-lg p-3">
            Please review the form fields and try again.
        </div>
        {% endif %}
        <div class="md:col-span-2">
            <label class="block text-sm font-medium text-slate-600 mb-1">Student</label>
            <select name="student_id" class="w-full border border-slate-200 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-accent/30" required>
                <option value="">Select student</option>
                {% for student in students %}
                <option value="{{ student.id }}">{{ student.full_name }}</option>
                {% endfor %}
            </select>
        </div>
        <div>
            <label class="block text-sm font-medium text-slate-600 mb-1">Category</label>
            <select name="category" class="w-full border border-slate-200 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-accent/30" required>
                {% for category in categories %}
                <option value="{{ category.id }}">{{ category.name }}</option>
                {% endfor %}
            </select>
        </div>
        <div>
            <label class="block text-sm font-medium text-slate-600 mb-1">Score (0-10)</label>
            <input type="number" name="score" min="0" max="10" class="w-full border border-slate-200 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-accent/30" required>
        </div>
        <div class="md:col-span-2">
            <label class="block text-sm font-medium text-slate-600 mb-1">Note</label>
            <input type="text" name="note" class="w-full border border-slate-200 rounded-lg px-4 py-2 focus:outline-none focus:ring-2 focus:ring-accent/30" placeholder="Optional note">
        </div>
        <div class="md:col-span-2">
            <button type="submit" class="w-full bg-accent hover:bg-black text-white font-semibold rounded-lg py-2 transition">
                Save Points
            </button>
        </div>
    </form>
</div>
{% endblock %}

